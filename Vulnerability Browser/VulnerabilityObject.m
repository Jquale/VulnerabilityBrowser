//
//  VulnerabilityObject.m
//  CSE494_Assignment4
//
//  Created by twslezak on 10/3/14.
//  Copyright (c) 2014 Thomas Slezak. All rights reserved.
//

#import "VulnerabilityObject.h"

@implementation VulnerabilityObject

-(id)initWithJSONDictionary:(NSDictionary *)dict
{
    if(self = [super init])
    {
        self.vulnCveID = dict[@"cve_id"];
        self.vulnCweID = dict[@"cwe_id"];
        self.vulnPublishDate = dict[@"publish_date"];
        self.vulnScore = dict[@"cvss_score"];
        self.vulnSummary = dict[@"summary"];
        self.vulnURL = dict[@"url"];
        [self setColor];
    }
    return self;
}

// initializing the object from parse
-(id)initWithDataFromParse:(NSString *)name
                  vulnDate:(NSString *)date
                 vulnScore:(NSString *)score
               vulnSummary:(NSString *)summary
{
    if(self = [super init])
    {
        self.vulnCveID = name;
        self.vulnPublishDate = date;
        self.vulnScore = score;
        self.vulnSummary = summary;
        [self setColor];
    }
    return self;
}

- (void)setColor {
    double score = [self.vulnScore doubleValue];
    
    if (score >= 9) {
        self.vulnCellColor = [UIColor colorWithRed:1 green:0.1 blue:0 alpha:1];
    } else if (score >= 8) {
        self.vulnCellColor = [UIColor colorWithRed:1 green:0.2 blue:0 alpha:1];
    } else if (score >= 7) {
        self.vulnCellColor = [UIColor colorWithRed:1 green:0.3 blue:0 alpha:1];
    } else if (score >= 6) {
        self.vulnCellColor = [UIColor colorWithRed:1 green:0.4 blue:0 alpha:1];
    } else if (score >= 5) {
        self.vulnCellColor = [UIColor colorWithRed:1 green:0.5 blue:0 alpha:1];
    } else if (score >= 4) {
        self.vulnCellColor = [UIColor colorWithRed:1 green:0.6 blue:0 alpha:1];
    } else if (score >= 3) {
        self.vulnCellColor = [UIColor colorWithRed:1 green:0.7 blue:0 alpha:1];
    } else if (score >= 2) {
        self.vulnCellColor = [UIColor colorWithRed:1 green:0.8 blue:0 alpha:1];
    } else if (score >= 1) {
        self.vulnCellColor = [UIColor colorWithRed:1 green:0.9 blue:0 alpha:1];
    } else {
        self.vulnCellColor = [UIColor colorWithRed:1 green:1 blue:0 alpha:1];
    }
}

- (NSString *)description
{
    return [NSString stringWithFormat:@"\nPublish Date: %@ \n\nCVE Score: %@ \n\nSummary: %@", self.vulnPublishDate, self.vulnScore, self.vulnSummary];
}

@end
